
#include "alignment_parameters.h"

#include "alphabet.h"
int set_subm_gaps(struct aln_param* ap);
int set_subm_gaps_DNA(struct aln_param* ap);
int set_param_number(struct aln_param* ap,int L, int sel);
int read_aln_param_from_file(struct aln_param* ap, char* infile, int L);

struct aln_param* init_ap(int numseq,int L)
{
        struct aln_param* ap = NULL;
        int i,j;




        MMALLOC(ap, sizeof(struct aln_param));

        ap->tree = NULL;
        MMALLOC(ap->tree, sizeof(int) * (numseq*3+1));

        for(i = 0;i < (numseq*3+1);i++){
                ap->tree[i] = 0;
        }
        ap->subm = NULL;

        RUNP(ap->rng = init_rng(0));
        //srand48_r(time(NULL), &ap->randBuffer);
        MMALLOC(ap->subm,sizeof (float*) * 32);
        for (i = 32;i--;){
                ap->subm[i] = NULL;
                MMALLOC(ap->subm[i],sizeof(float) * 32);
                for (j = 32;j--;){
                        ap->subm[i][j] = 0.0f;
                }
        }
        //if(param->param_set == -1){

        if(L ==defDNA){
                LOG_MSG("DNADNADNA");
                //exit(0);
                RUN(set_subm_gaps_DNA(ap));
        }else if(L == defPROTEIN){

                RUN(set_subm_gaps(ap));
        }
                //}else{
                //set_param_number(ap, L, param->param_set);
                //}
        /* read parameters from file */
        //if(param->aln_param_file){
                //LOG_MSG("Reading parameters from file: %s", param->aln_param_file);
                //RUN(read_aln_param_from_file(ap, param->aln_param_file, L));
                //}


        return ap;
ERROR:
        free_ap(ap);
        return NULL;
}

int read_aln_param_from_file(struct aln_param* ap, char* infile, int L)
{
        char line_buffer[BUFFER_LEN];
        FILE* f_ptr = NULL;
        double* values = NULL;
        int i,j;
        int m_pos;
        double val = 0;

        int expected;


        expected = (L * (L-1)) / 2 + L + 3;

        MMALLOC(values, sizeof(double) * expected); /* NEED to remove constant!!!  */

        if(!my_file_exists(infile)){
                ERROR_MSG("File: %s does not exist", infile);
        }
        RUNP( f_ptr = fopen(infile, "r"));

        m_pos =0;
        while (fgets(line_buffer , BUFFER_LEN, f_ptr)){
                sscanf(line_buffer, "%lf", &val);
                values[m_pos] = val;
                m_pos++;
                //fprintf(stdout,"%s", ret);
        }

        //fprintf(stdout,"-%s-", ret);


        if(expected != m_pos){
                ERROR_MSG("Expected number of parameters (%d) do not match number of parameters in file %s (%d)", expected,infile,m_pos);
        }

        m_pos = 0;
        for (i = 0;i < L;i++){
                for (j = 0;j <= i;j++){

                        ap->subm[i][j] = values[m_pos];
                        ap->subm[j][i] = ap->subm[i][j];
                        m_pos++;
                }
        }

        ap->gpo = values[m_pos];
        m_pos++;
        ap->gpe = values[m_pos];
        m_pos++;

        ap->tgpe = values[m_pos];

        MFREE(values);
        fclose(f_ptr);

        return OK;
ERROR:
        return FAIL;
}

int set_param_number(struct aln_param* ap,int L, int sel)
{
        int i,j,m_pos;
        double* ptr = NULL;

        double defprot_set10[4][234] = {{ 2.441135 ,0.804586,5.229447,-0.275312,-0.932531,3.078253,0.117964,-1.112335,1.203915,2.665036,-0.478196,0.062497,-1.199822,-1.106372,3.544699,0.243667,-0.629188,-0.166715,-0.522073,-1.419407,3.295848,-0.252812,-0.304885,0.225093,0.189015,0.248641,-0.700361,4.058245,-0.116301,0.221291,-1.419282,-1.003624,0.588717,-1.604453,-0.759925,2.735987,0.182665,-0.915737,0.321957,0.857994,-1.022471,-0.334935,0.297575,-0.784649,2.621895,-0.172126,0.172567,-1.153285,-0.827709,1.022751,-1.503650,-0.309763,1.354375,-0.528795,2.504544,0.090768,0.449192,-0.994454,-0.448665,0.881127,-1.049855,-0.151963,0.958608,-0.219735,1.535655,3.595027,-0.078957,-0.296744,1.113714,0.378894,-0.733749,0.377618,0.809122,-1.043225,0.560572,-0.659316,-0.266522,3.114087,0.077683,-0.717091,-0.075007,-0.003924,-0.752411,-0.544078,-0.270432,-0.714819,-0.032959,-0.715190,-0.657222,-0.232401,3.808283,0.209099,-0.576439,0.480587,1.082240,-0.622755,-0.442365,0.731248,-0.597657,1.065589,-0.192281,0.282779,0.572326,-0.163616,2.996754,-0.216587,-0.556078,-0.276231,0.165220,-0.918021,-0.771466,0.554353,-0.743857,1.327472,-0.543696,-0.286912,0.152924,-0.544813,0.760249,3.307940,0.862154,0.406596,0.359384,0.221433,-0.719529,0.199665,0.082347,-0.820916,0.216351,-0.743032,-0.184038,0.754032,0.186512,0.303803,-0.080536,2.664838,0.340064,0.423405,-0.046178,0.011205,-0.507827,-0.516927,-0.055173,-0.010057,0.160184,-0.246784,0.196552,0.363234,-0.210271,0.156528,-0.168975,1.174802,2.941623,0.405328,0.778105,-1.278921,-0.843631,0.290444,-1.474030,-0.519590,1.808021,-0.548076,0.844055,0.587147,-0.776456,-0.532748,-0.462248,-0.630362,-0.455832,0.518245,2.608431,-0.514309,-0.347037,-1.197980,-0.918742,1.470235,-1.258146,0.590844,-0.170494,-0.813930,0.109186,0.385784,-0.639783,-0.857979,-0.484561,-0.631388,-0.601573,-0.599450,-0.220994,5.505481,-0.357527,-0.191207,-0.925302,-0.866943,1.973688,-1.203284,1.101391,-0.080217,-0.573368,0.265681,0.335302,-0.388156,-0.855382,-0.290231,-0.315724,-0.517638,-0.432202,-0.138017,1.636025,3.872373,1.681627,0.937222,2.171531,-0.001955,-0.764385,-0.115077,-0.025456,0.620326,2.017909,0.064413,0.122257,0.283459,2.263544,0.488142,0.407935,0.793370,0.866565,0.434452,0.959704,-0.491955,15.191782,3.610458,0.378310,0.006965},
{ 2.375830 ,0.643607,5.204934,-0.249461,-1.173050,3.172340,0.192837,-1.161841,1.093372,2.710988,-0.401979,-0.156276,-1.082798,-0.903211,3.434700,0.146163,-0.753883,-0.281686,-0.506025,-0.867086,3.140448,-0.341275,-0.662201,0.089096,0.085106,0.143585,-0.504392,4.277457,-0.160461,-0.027477,-1.482790,-1.091093,0.585205,-1.579484,-0.771554,2.841786,0.153642,-1.213189,0.278857,0.860792,-0.897669,-0.341059,0.280853,-0.865861,2.698454,-0.171662,-0.185907,-1.303096,-0.882391,1.030682,-1.331878,-0.406372,1.341062,-0.610478,2.549526,0.074865,0.259681,-0.892696,-0.553258,1.001488,-1.028818,-0.273395,0.982579,-0.227282,1.441501,3.773014,-0.155071,-0.360285,0.950083,0.303635,-0.666252,0.153988,0.769154,-1.107452,0.331698,-0.746403,-0.521854,3.255696,-0.165589,-0.340985,-0.185337,0.059935,-0.340691,-0.326977,-0.467090,-0.829518,-0.133347,-0.614695,-0.668856,-0.099074,3.706510,0.103590,-0.720914,0.413633,1.047622,-0.446286,-0.538221,0.626237,-0.709933,0.965443,-0.296786,0.237723,0.417615,-0.120407,3.110847,-0.088261,-0.704532,-0.124559,0.455879,-0.703728,-0.701110,0.466465,-0.718099,1.318186,-0.419700,-0.184599,0.296735,-0.130674,0.927516,3.208160,0.758824,0.095418,0.309572,0.255178,-0.477662,0.166401,-0.056159,-0.792113,0.209069,-0.715987,-0.306894,0.537011,0.108416,0.257043,0.085939,2.590287,0.298809,0.438208,-0.109154,0.072396,-0.189854,-0.434899,-0.020938,-0.117846,0.157773,-0.237370,0.033414,0.220778,-0.150298,0.249437,0.158230,1.121004,2.827351,0.304373,0.589297,-1.217991,-0.745985,0.318079,-1.316178,-0.573843,1.760337,-0.547804,0.877044,0.668480,-0.902387,-0.401172,-0.437892,-0.580874,-0.477051,0.369209,2.616250,-0.735670,-0.888142,-0.490997,-0.757002,1.491052,-0.854143,0.408417,-0.289839,-0.822824,0.084759,0.237157,-0.467658,-0.908696,-0.278850,-0.281685,-0.225505,-0.363700,-0.517814,5.404440,-0.445265,-0.443508,-0.624691,-0.558171,1.873487,-0.883587,0.883846,-0.224340,-0.458380,0.207657,0.276651,-0.487803,-0.547611,-0.040354,-0.023209,-0.286858,-0.255100,-0.244120,1.783873,3.796554,0.284200,0.077413,1.186291,1.219788,0.347297,-0.586510,-0.620932,0.601297,0.662807,0.455680,1.132707,0.727649,-1.095943,1.930136,-0.521231,0.693074,0.349914,0.299677,-1.077936,-0.408848,5.696912,3.555584,0.356512,0.005053},
{ 2.988765 ,0.330658,6.048533,-0.372999,-1.742733,3.355200,-0.111936,-1.441599,1.001284,3.255966,-1.296498,-0.009322,-2.206448,-2.124382,3.641940,0.220432,-1.208191,-0.136338,-0.700479,-1.834093,3.354263,-0.806861,-0.518831,-0.391664,-0.448703,-0.138816,-1.000365,4.531540,-0.458200,-0.773621,-1.836550,-1.328077,0.249780,-1.869329,-1.983229,3.246271,0.098474,-0.668583,-0.220930,0.268151,-2.047742,-0.625460,-0.453621,-1.241727,3.605983,-0.828022,-0.213279,-2.056982,-1.590836,0.527728,-2.047133,-1.877396,1.103220,-1.258418,2.986776,-0.723798,-0.379368,-1.803284,-1.323239,0.214706,-1.797275,-1.082570,0.781156,-0.807643,1.257172,4.823113,-0.306136,-0.774508,0.994684,-0.109040,-1.280948,0.251180,0.419551,-0.988364,0.090954,-1.389571,-1.361113,2.994998,0.142169,-0.165729,-0.637585,-0.797158,-1.731014,-0.608888,-1.184747,-1.369715,-0.407386,-1.399763,-1.536961,-0.516908,4.004747,-0.114701,-0.494646,0.018146,0.971865,-1.456246,-0.569627,0.213520,-1.029848,1.136034,-0.937544,-0.255363,0.265655,-0.326582,3.448932,-0.251985,-0.585584,-0.438468,-0.072998,-1.351157,-0.826051,-0.161218,-1.252762,1.447143,-0.941115,-1.055739,0.048983,-0.655716,0.888946,3.372770,0.693722,0.213017,0.124399,-0.253277,-1.099570,0.154263,-0.763192,-0.919637,-0.284745,-1.078317,-0.839221,0.758804,0.096349,0.097942,-0.140681,2.760864,0.074674,-0.733432,-0.390260,-0.161833,-1.140534,-0.969146,-1.347766,-0.015379,0.093481,-0.775850,-0.118827,0.250024,-0.459992,0.046860,-0.033931,1.018917,3.083992,0.335871,0.106340,-1.755562,-1.113193,-0.327028,-1.692354,-1.970581,1.840384,-0.995567,0.403277,0.473676,-1.380651,-0.847685,-0.969741,-1.183394,-0.948561,0.127447,3.248558,-1.677426,-1.771605,-2.385338,-1.744890,0.198857,-2.256367,-0.465483,-1.811524,-2.492853,-1.188690,-0.640855,-2.791854,-1.573229,-1.866240,-1.559244,-1.814671,-1.882153,-1.824870,5.387924,-1.161668,-0.657621,-1.193655,-1.380692,1.584365,-1.809631,0.788082,-1.233994,-1.582458,-0.374156,-0.552714,-1.283069,-1.770388,-1.336656,-0.976387,-1.070930,-1.387361,-1.263470,-0.092070,3.852683,4.438058,7.271657,4.565167,4.479790,4.709276,4.265295,5.534752,4.712102,5.107466,3.930502,6.200284,4.618413,4.974178,5.182669,4.633832,4.421237,4.559339,4.531892,5.911335,4.786914,21.954597,3.794700,0.421863,0.027185},
{ 2.232931 ,1.057775,3.872678,0.169553,-0.103676,2.758993,0.369081,-0.135230,1.157821,2.383283,-0.102529,0.258417,-0.662975,-0.612489,3.413148,0.481787,0.212790,0.371571,-0.012080,-0.633158,3.039450,0.034057,0.225904,0.338794,0.225409,0.327077,-0.080396,3.825504,0.207216,0.644692,-0.632450,-0.372329,0.666708,-0.789520,-0.390353,2.659703,0.465312,0.091239,0.445652,0.797031,-0.503043,-0.014689,0.370923,-0.278195,2.259899,0.170175,0.572394,-0.537310,-0.297406,0.962193,-0.658364,-0.099282,1.418371,-0.142005,2.326511,0.519208,0.911975,-0.348098,-0.080380,0.760070,-0.352575,0.063337,1.177040,0.011250,1.395354,3.286165,0.249498,0.165238,1.087545,0.549153,-0.283970,0.578362,0.925880,-0.436958,0.606512,-0.314716,-0.114963,2.672350,0.409597,-0.035851,0.244759,0.313980,-0.474016,0.216863,0.023327,-0.386687,0.289280,-0.260558,-0.101728,0.311883,3.074851,0.426409,0.289590,0.647739,1.076847,-0.346301,0.161717,0.712282,-0.186318,0.991033,0.004614,0.271507,0.602110,0.276272,2.471184,0.182095,0.250206,0.127889,0.447480,-0.349322,-0.161525,0.481948,-0.249548,1.252403,-0.111172,0.079122,0.464390,0.106980,0.720093,2.869985,0.791158,0.874919,0.556542,0.393894,-0.239243,0.466838,0.444613,-0.230905,0.448122,-0.110508,0.187499,0.772252,0.578583,0.637750,0.358795,1.963403,0.524514,0.661450,0.403349,0.426756,-0.144736,0.083357,0.284615,0.237865,0.572066,0.139552,0.428595,0.585936,0.263856,0.524917,0.371733,1.144194,2.356782,0.596024,0.988593,-0.478686,-0.156852,0.535219,-0.513215,-0.227649,1.806518,-0.049600,0.986069,0.830472,-0.269083,-0.181403,0.058759,-0.143302,0.026346,0.457791,2.430302,-0.376166,0.414717,-0.715912,-0.599316,1.426047,-0.699126,0.215677,-0.055418,-0.275381,0.298257,0.272396,-0.601420,-0.669864,-0.210639,-0.313587,-0.512138,-0.328567,-0.068667,5.370957,-0.029636,0.429613,-0.408193,-0.443011,2.040433,-0.524910,1.127206,0.219616,-0.277388,0.324859,0.266845,-0.083663,-0.397247,-0.171474,-0.114692,-0.151616,-0.074518,0.231096,1.860899,3.592874,0.442121,1.658955,0.638475,0.303002,1.696762,-0.132350,0.415602,1.117820,0.167463,0.921516,2.669780,0.844726,0.133353,-0.747866,-0.440784,0.428838,-0.201140,0.162823,1.468113,1.364092,6.001722,3.747994,0.313172,-0.001827}
};
        ptr = defprot_set10[sel];
        m_pos = 0;
        for (i = 0;i < L;i++){
                for (j = 0;j <= i;j++){

                        ap->subm[i][j] = ptr[m_pos];
                        ap->subm[j][i] = ap->subm[i][j];
                        m_pos++;
                }
        }

        ap->gpo = ptr[m_pos];
        m_pos++;
        ap->gpe = ptr[m_pos];
        m_pos++;

        ap->tgpe = ptr[m_pos];

        return OK;
}


void free_ap(struct aln_param* ap)
{
        int i;
        if(ap){
                if(ap->subm){
                        for (i = 32;i--;){
                                MFREE(ap->subm[i]);
                        }
                        MFREE(ap->subm);
                }
                if(ap->rng){
                        free_rng(ap->rng);
                }
                if(ap->tree){
                        MFREE(ap->tree);
                }
                MFREE(ap);
        }
}


int set_subm_gaps_DNA(struct aln_param* ap)
{
        int i,j;


        for(i = 0; i < 5; i++){

                for(j =0; j < 5;j++){
                        ap->subm[i][j] = 283;
                }
        }
        //	A   91 -114  -31 -123    0  -43
        ap->subm[0][0] += 91;
        ap->subm[0][1] += -114;
        ap->subm[0][2] += -31;
        ap->subm[0][3] += -123;

//	C -114  100 -125  -31    0  -43
        ap->subm[1][0] += -114;
        ap->subm[1][1] += 100;
        ap->subm[1][2] += -125;
        ap->subm[1][3] += -31;

//	G  -31 -125  100 -114    0  -43
        ap->subm[2][0] += -31;
        ap->subm[2][1] += -125;
        ap->subm[2][2] += 100;
        ap->subm[2][3] += -114;

//	T -123  -31 -114   91    0  -43
        ap->subm[3][0] += -123;
        ap->subm[3][1] += -31;
        ap->subm[3][2] += -114;
        ap->subm[3][3] += 91;

        ap->gpo = 217;
        ap->gpe = 39.4;
        ap->tgpe =  292.6;
        //param->secret = 28.3;
 			  //		     A    C    G    T    .    N

        return OK;
}
int set_subm_gaps(struct aln_param* ap)
{
        int i,j;
        int m_pos = 0;
        short *matrix_pointer = 0;
        short blosum50mt[]={
                5,
                -2,  5,
                -1, -3, 13,
                -2,  5, -4,  8,
                -1,  1, -3,  2,  6,
                -3, -4, -2, -5, -3,  8,
                0, -1, -3, -1, -3, -4,  8,
                -2,  0, -3, -1,  0, -1, -2, 10,
                -1, -4, -2, -4, -4,  0, -4, -4,  5,
                -1,  0, -3, -1,  1, -4, -2,  0, -3,  6,
                -2, -4, -2, -4, -3,  1, -4, -3,  2, -3,  5,
                -1, -3, -2, -4, -2,  0, -3, -1,  2, -2,  3,  7,
                -1,  4, -2,  2,  0, -4,  0,  1, -3,  0, -4, -2,  7,
                -1, -2, -4, -1, -1, -4, -2, -2, -3, -1, -4, -3, -2, 10,
                -1,  0, -3,  0,  2, -4, -2,  1, -3,  2, -2,  0,  0, -1,  7,
                -2, -1, -4, -2,  0, -3, -3,  0, -4,  3, -3, -2, -1, -3,  1,  7,
                1,  0, -1,  0, -1, -3,  0, -1, -3,  0, -3, -2,  1, -1,  0, -1,  5,
                0,  0, -1, -1, -1, -2, -2, -2, -1, -1, -1, -1,  0, -1, -1, -1,  2,  5,
                0, -4, -1, -4, -3, -1, -4, -4,  4, -3,  1,  1, -3, -3, -3, -3, -2,  0,  5,
                -3, -5, -5, -5, -3,  1, -3, -3, -3, -3, -2, -1, -4, -4, -1, -3, -4, -3, -3, 15,
                -1, -1, -2, -1, -1, -2, -2, -1, -1, -1, -1, -1, -1, -2, -1, -1, -1,  0, -1, -3, -1,
                -2, -3, -3, -3, -2,  4, -3,  2, -1, -2, -1,  0, -2, -3, -1, -1, -2, -2, -1,  2, -1,  8,
                -1,  2, -3,  1,  5, -4, -2,  0, -3,  1, -3, -1,  0, -1,  4,  0,  0, -1, -3, -2, -1, -2,  5};

        short blosum62mt[]={
                40,
                -20,  40,
                0, -30,  90,
                -20,  40, -30,  60,
                -10,  10, -40,  20,  50,
                -20, -30, -20, -30, -30,  60,
                0, -10, -30, -10, -20, -30,  60,
                -20,  0, -30, -10,  0, -10, -20,  80,
                -10, -30, -10, -30, -30,  0, -40, -30,  40,
                -10,  0, -30, -10,  10, -30, -20, -10, -30,  50,
                -10, -40, -10, -40, -30,  0, -40, -30,  20, -20,  40,
                -10, -30, -10, -30, -20,  0, -30, -20,  10, -10,  20,  50,
                -20,  30, -30,  10,  0, -30,  0,  10, -30,  0, -30, -20,  60,
                -10, -20, -30, -10, -10, -40, -20, -20, -30, -10, -30, -20, -20,  70,
                -10,  0, -30,  0,  20, -30, -20,  0, -30,  10, -20,  0,  0, -10,  50,
                -10, -10, -30, -20,  0, -30, -20,  0, -30,  20, -20, -10,  0, -20,  10,  50,
                10,  0, -10,  0,  0, -20,  0, -10, -20,  0, -20, -10,  10, -10,  0, -10,  40,
                0, -10, -10, -10, -10, -20, -20, -20, -10, -10, -10, -10,  0, -10, -10, -10,  10,  50,
                0, -30, -10, -30, -20, -10, -30, -30,  30, -20,  10,  10, -30, -20, -20, -30, -20,  0,  40,
                -30, -40, -20, -40, -30,  10, -20, -20, -30, -30, -20, -10, -40, -40, -20, -30, -30, -20, -30, 110,
                0, -10, -20, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -20, -10, -10,  0,  0, -10, -20, -10,
                -20, -30, -20, -30, -20,  30, -30,  20, -10, -20, -10, -10, -20, -30, -10, -20, -20, -20, -10,  20, -10,  70,
                -10,  10, -30,  10,  40, -30, -20,  0, -30,  10, -30, -10,  0, -10,  30,  0,  0, -10, -20, -30, -10, -20,  40};

        short gon250mt[]={
                24,
                0,   0,
                5,   0, 115,
                -3,   0, -32,  47,
                0,   0, -30,  27,  36,
                -23,   0,  -8, -45, -39,  70,
                5,   0, -20,   1,  -8, -52,  66,
                -8,   0, -13,   4,   4,  -1, -14,  60,
                -8,   0, -11, -38, -27,  10, -45, -22,  40,
                -4,   0, -28,   5,  12, -33, -11,   6, -21,  32,
                -12,   0, -15, -40, -28,  20, -44, -19,  28, -21,  40,
                -7,   0,  -9, -30, -20,  16, -35, -13,  25, -14,  28,  43,
                -3,   0, -18,  22,   9, -31,   4,  12, -28,   8, -30, -22,  38,
                3,   0, -31,  -7,  -5, -38, -16, -11, -26,  -6, -23, -24,  -9,  76,
                -2,   0, -24,   9,  17, -26, -10,  12, -19,  15, -16, -10,   7,  -2,  27,
                -6,   0, -22,  -3,   4, -32, -10,   6, -24,  27, -22, -17,   3,  -9,  15,  47,
                11,   0,   1,   5,   2, -28,   4,  -2, -18,   1, -21, -14,   9,   4,   2,  -2,  22,
                6,   0,  -5,   0,  -1, -22, -11,  -3,  -6,   1, -13,  -6,   5,   1,   0,  -2,  15,  25,
                1,   0,   0, -29, -19,   1, -33, -20,  31, -17,  18,  16, -22, -18, -15, -20, -10,   0,  34,
                -36,   0, -10, -52, -43,  36, -40,  -8, -18, -35,  -7, -10, -36, -50, -27, -16, -33, -35, -26, 142,
                0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                -22,   0,  -5, -28, -27,  51, -40,  22,  -7, -21,   0,  -2, -14, -31, -17, -18, -19, -19, -11,  41,   0,  78,
                0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0};





/*
        float balimt[]={
 2.420415,
 0.747121, 5.209610,
 -0.246410, -0.997330, 3.110732,
 0.154379, -1.083321, 1.158678, 2.681517,
 -0.446025, -0.026154, -1.142319, -1.016057, 3.510761,
 0.214828, -0.642689, -0.186559, -0.494668, -1.147637, 3.225504,
 -0.288471, -0.426255, 0.171148, 0.146036, 0.212356, -0.596093, 4.148174,
 -0.123453, 0.128064, -1.409191, -1.007479, 0.584028, -1.557203, -0.763072, 2.787728,
 0.182504, -0.970337, 0.304663, 0.850675, -0.957835, -0.325461, 0.284162, -0.794586, 2.647806,
 -0.164024, 0.040247, -1.186639, -0.825884, 1.013671, -1.391315, -0.354153, 1.348207, -0.545169, 2.523593,
 0.095638, 0.384396, -0.928356, -0.474076, 0.910479, -1.012954, -0.196555, 0.975663, -0.215075, 1.488754, 3.676938,
 -0.100049, -0.307696, 1.045118, 0.346370, -0.694593, 0.293164, 0.790324, -1.038712, 0.462057, -0.689173, -0.375917, 3.162906,
 -0.005026, -0.500290, -0.107106, 0.030602, -0.585839, -0.408680, -0.333466, -0.751461, -0.053477, -0.654948, -0.632932, -0.147628, 3.733436,
 0.168344, -0.583855, 0.455039, 1.066222, -0.553248, -0.449522, 0.682319, -0.627493, 1.021972, -0.232310, 0.256122, 0.506081, -0.116212, 3.027675,
 -0.155350, -0.577987, -0.201476, 0.286056, -0.811536, -0.717588, 0.513573, -0.717277, 1.320853, -0.479287, -0.237731, 0.219607, -0.342189, 0.822743, 3.266591,
 0.809518, 0.299711, 0.345164, 0.235684, -0.601382, 0.197465, 0.041369, -0.779745, 0.220501, -0.694139, -0.216848, 0.671367, 0.186857, 0.306560, 0.008706, 2.601806,
 0.325929, 0.428172, -0.053208, 0.053395, -0.374081, -0.460208, -0.043498, -0.040764, 0.179361, -0.231187, 0.142381, 0.316464, -0.162358, 0.212028, -0.011513, 1.148277, 2.881259,
 0.371841, 0.702162, -1.218901, -0.772785, 0.300936, -1.357957, -0.544881, 1.791316, -0.525849, 0.857932, 0.629459, -0.812818, -0.466289, -0.431884, -0.596182, -0.445733, 0.451791, 2.617557,
 -0.623582, -0.538328, -0.883882, -0.857629, 1.448970, -1.073929, 0.484818, -0.241197, -0.810376, 0.083866, 0.302183, -0.604871, -0.881386, -0.412425, -0.500269, -0.462709, -0.516104, -0.354963, 5.476864,
 -0.394793, -0.272838, -0.780817, -0.731373, 1.935874, -1.041866, 1.023095, -0.140141, -0.527044, 0.233800, 0.293401, -0.428925, -0.715600, -0.200490, -0.206814, -0.410650, -0.359953, -0.179508, 1.672116, 3.837386,
 0.403734, 0.257111, 1.168383, 1.140554, 0.286065, -0.513383, -0.693256, 0.616968, 0.654148, 0.450973, 1.131462, 0.783884, -1.080134, 1.898639, -0.669949, 0.691191, 0.331165, 0.327000, -1.045717, -0.407346, 6.987463,
};
        ap->gpo = 3.598325;
        ap->gpe =  0.365616;
        ap->tgpe =  0.004882;
*/
        /*
        float balimt[]={
 4.662629,
 2.431772, 7.709396,
 0.507180, -1.493691, 5.610641,
 1.278484, -1.228899, 2.317371, 5.150754,
 0.107950, -0.021073, -1.292390, -2.024317, 6.008839,
 0.429702, -0.285378, -0.371180, -0.489313, -1.295274, 5.694284,
 0.419182, 0.085020, 1.312999, 0.854565, 1.174739, -0.222460, 6.585703,
 0.749218, 1.256128, -2.568393, -1.016881, 2.136806, -2.116329, -0.557364, 5.272134,
 1.364916, -0.999269, 0.609341, 0.702296, -1.164697, 0.348864, 1.568110, -0.589203, 5.147776,
 0.671952, 0.080631, -1.373278, -1.151745, 2.527365, -1.798225, 0.233008, 3.696414, -0.559095, 5.023593,
 1.191276, 1.768792, -0.864036, -0.448160, 1.820973, -1.025908, 0.106913, 2.951112, 0.569850, 3.977508, 6.176938,
 0.792150, 0.384608, 3.086360, 1.692679, -0.420192, 1.586328, 2.580648, -2.047074, 1.814280, -0.378804, 0.013787, 5.662784,
 0.958728, -1.500603, 0.770193, 0.561227, -0.171678, 0.174858, 0.333037, -0.518486, -0.106939, -0.309896, -0.273646, 0.704744, 6.233436,
 0.836833, -0.167710, 1.910078, 2.632223, -0.106496, -0.899029, 0.427108, -0.754505, 2.981473, 0.535166, 1.512244, 2.012162, 0.751981, 5.277701,
 -0.302903, -0.155974, 0.580477, 1.572112, -0.870634, -0.435176, 2.027146, -0.496811, 3.641706, 0.041426, 0.493318, 1.439214, 0.066381, 2.629891, 5.516618,
 2.369063, 0.599651, 1.690328, 0.473306, -0.202856, 1.380068, 1.082738, -0.559704, 1.440544, -0.389224, 0.566304, 2.342734, 1.360042, 1.613120, 1.017412, 4.601859,
 1.651858, 1.106333, -0.105455, 1.106790, 0.250861, -0.389204, 0.475497, 0.910690, 1.350940, 0.537168, 1.253542, 1.632928, 0.675192, 1.408553, 0.945754, 3.171583, 4.631248,
 1.493922, 2.373135, -1.937779, -0.791668, 1.478366, -3.715456, -0.213787, 4.580709, -0.051698, 2.654340, 2.243323, -0.625636, -0.916968, 0.136232, -0.442337, 0.077314, -0.095472, 5.117557,
 -0.247164, -0.084224, -0.767764, -1.711367, 3.804188, -1.209962, 1.954041, 0.517606, -1.120760, 1.159950, 0.606304, -0.272212, -0.762772, -0.340452, -0.006489, -0.175391, -0.032208, 0.229526, 7.976864,
 0.193843, -0.045653, -0.562092, -0.521341, 4.621775, -1.144371, 3.042192, 0.719718, -0.081432, 1.467600, 1.586802, 0.141692, -0.431200, 0.598562, 0.086395, 0.178700, -0.157413, 0.640984, 4.342309, 6.335586,
 1.744998, 1.498627, 2.953978, 3.281108, 1.509660, -0.057986, -0.386756, 2.233936, 1.316093, 1.901946, 3.212172, 2.091442, -1.162191, 4.793189, -0.589871, 2.380459, 1.170104, 1.638497, -1.107090, 0.185308, 9.483618,
};
ap->gpo = 4.348321;
ap->gpe =  0.037633;
ap->tgpe =  0.007176;
*/
        /*
float balimt[]={
 4.920415,
 2.494242, 7.272103,
 0.507180, -0.994660, 5.610732,
 1.277630, -1.197404, 3.315891, 5.181517,
 0.107950, 0.932189, -1.284638, -1.032114, 5.948291,
 1.429656, -0.285866, 0.502857, -0.489313, -1.295274, 5.725504,
 0.423027, 0.147398, 1.338420, 1.292072, 1.424620, -0.192278, 5.706784,
 0.737499, 1.226831, -1.818382, -1.015965, 1.668079, -2.114406, -0.526144, 5.287728,
 1.365008, -0.956147, 1.609326, 2.701350, -0.931265, 0.349078, 1.568324, -0.620392, 4.898291,
 0.671952, 1.080494, -1.404467, -1.151745, 2.902371, -1.782630, 0.291602, 3.446654, -0.090338, 4.523616,
 1.183494, 1.768792, -0.856712, 0.051848, 2.820958, -3.025908, 0.110789, 2.951326, 0.569758, 3.977508, 6.051967,
 0.549929, 0.159019, 3.074702, 1.689322, -1.139228, 1.586328, 2.580648, -1.101320, 1.924114, -0.378346, 0.248166, 5.412902,
 -0.010037, -0.000641, 0.785788, 0.998703, -0.202898, 0.057669, 0.331145, -0.502922, 0.643073, -0.311819, -0.265864, 0.704744, 6.108465,
 1.274218, -0.183091, 1.675699, 3.132444, -0.106496, 0.100926, 2.337294, -0.270581, 3.043944, 0.285407, 1.512244, 2.012162, 0.267599, 5.527461,
 0.689208, -0.155974, 0.596102, 1.572112, -0.623072, -0.560147, 2.011521, -0.465774, 3.641706, -0.019122, 0.524538, 1.188997, 0.315408, 1.646447, 5.766133,
 2.619036, 0.599437, 1.690328, 1.408928, -0.702741, 1.394899, 1.082738, -0.559490, 1.378532, -0.513158, 0.562459, 2.342734, 0.873951, 1.581900, 1.017320, 4.976834,
 1.589388, 1.856344, 0.893584, 1.106790, 0.251838, -0.168467, 0.913004, 0.160678, 1.358722, 0.522031, 1.284548, 1.195421, 0.675192, 1.422133, 0.852216, 3.296554, 5.380313,
 1.743682, 2.404294, -2.436841, -1.030166, 1.599949, -1.723696, -0.089762, 4.582174, -0.051698, 2.653394, 2.196478, -0.633418, 0.059640, -0.363745, -0.192364, 0.077528, 0.907473, 5.117557,
 -0.372135, -0.576542, -1.267741, -0.715258, 3.897940, -1.147858, 1.969636, 0.267633, -0.620752, 1.167732, 1.494989, -0.272212, -0.770554, -0.824835, -0.000538, -0.925189, -0.032208, 0.040131, 7.976864,
 -0.023965, 0.438729, -0.561634, -0.462746, 2.871748, -1.083732, 3.046190, 0.719718, -0.179059, 0.967623, 1.586802, 0.142150, -0.431200, 0.599020, -0.413155, 0.178700, 0.276218, 0.640984, 4.328637, 6.337386,
 1.557495, 1.483368, 3.336766, 3.281108, 1.572130, -0.276739, -0.386512, 2.232990, 2.308296, 1.901946, 3.138166, 2.567768, -1.160268, 4.797278, -0.464686, 1.882405, 1.162444, 1.654000, -1.091434, 0.185308, 9.487371,
};
ap->gpo = 4.590543;
ap->gpe =  0.128195;
ap->tgpe =  0.007222;
*/

float balimt[]={
 4.920415,
 2.463236, 7.705734,
 0.507180, -0.994660, 5.609786,
 1.308758, -1.229112, 1.441870, 4.181532,
 0.107950, 0.946837, -1.347108, -1.149303, 6.010761,
 1.429656, -0.347757, 0.626882, -0.239309, -2.295228, 4.729303,
 0.423058, 0.139708, 1.218271, 1.288379, 1.174739, -0.207781, 5.651973,
 0.628123, 0.756151, -2.068325, -1.018803, 2.166133, -2.115352, -0.526144, 4.912723,
 1.365008, -1.440651, 1.609326, 2.451407, -0.915884, 0.347155, 1.568324, -2.581390, 5.147806,
 0.421979, 1.080036, -2.372439, -0.714238, 3.027342, -2.782615, 0.291694, 3.696414, -0.090369, 5.007998,
 1.066305, 1.534413, -0.856712, 0.051390, 2.820744, -1.027831, 0.606798, 2.951326, 0.569850, 3.977508, 6.176938,
 0.784307, 0.383662, 3.074641, 1.677237, -0.389186, 1.398825, 2.580648, -1.077424, 1.705361, -0.877377, 0.216946, 5.635348,
 0.989948, -1.000107, 0.778006, 1.061204, -0.202898, 0.182182, 0.225644, -1.002899, 0.893046, -0.310842, -0.265864, 0.704744, 6.108465,
 1.336688, -0.167710, 1.410101, 3.132352, -0.106496, 0.100956, 1.364653, -0.254986, 3.036162, 0.027926, 1.481024, 2.011185, 0.767118, 5.519893,
 0.219597, -0.155974, -0.402937, 1.447141, -0.685542, -0.435207, 1.027161, -0.497024, 3.391946, 0.041426, 0.524538, 0.466543, 0.315622, 2.645486, 5.766591,
 2.517533, 1.599422, 1.565448, 1.221364, -0.515238, 1.394442, 0.953860, -0.559582, 1.440788, -0.388278, 0.550709, 2.342734, 1.373714, 1.613120, 0.533030, 5.039305,
 1.651858, 1.856344, 0.893584, 1.099954, 0.251808, 0.048364, 0.905222, 0.668499, 0.421208, 0.537199, 1.159791, 1.390737, 0.613027, 0.908484, 0.852003, 3.048503, 5.377414,
 1.743224, 2.404324, -1.453397, -1.045547, 1.601872, -1.747134, -0.090708, 4.520162, -0.051698, 2.715864, 2.258918, -1.602183, 0.036416, 0.136232, -0.317335, -0.391443, -0.096418, 4.117572,
 -0.247164, -0.076656, -0.767764, -0.715258, 3.897940, -2.147843, 1.969636, 0.517606, -0.622675, 1.105262, 1.573177, -0.209742, -0.762772, 0.050179, -0.000752, -0.175300, -0.032208, 0.282292, 7.961269,
 0.208583, 0.438699, -1.561619, -0.587717, 4.871748, -1.960576, 2.046205, 0.719718, -0.116558, 1.358254, 0.586817, 0.126555, -0.446795, 0.599020, 0.586372, 0.178700, 0.276218, 0.640984, 4.337396, 6.212415,
 1.807468, 1.483002, 3.086793, 3.281108, 0.572878, -0.964280, -0.386543, 2.171466, 2.307350, 1.901946, 3.137953, 2.317764, -1.221792, 4.734807, -0.355493, 2.366757, 1.412357, 0.655938, -1.091434, 0.185308, 8.518698,
};
ap->gpo = 4.598325;
ap->gpe =  0.037633;
ap->tgpe =  0.000307;
m_pos = 0;
        for (i = 0;i < 21;i++){
                for (j = 0;j <= i;j++){
                        if (i == j){
                                //	subm[i][j] += blosum62mt[m_pos]*10;
                                ap->subm[i][j] = balimt[m_pos];
                        }else{
                                //	subm[i][j] += blosum62mt[m_pos]*10;
                                //	subm[j][i] += blosum62mt[m_pos]*10;
                                ap->subm[i][j] = balimt[m_pos];
                                ap->subm[j][i] = balimt[m_pos];
                        }
                        m_pos++;
                }
        }

        return OK;
}
